{% if page.toc != false %}
<nav class="toc">
  <h4>{{ page.toc_title | default: "Contents" }}</h4>
  <ul>
    {%- assign headers = content | markdownify | split:"<h" -%}
    {%- for h in headers -%}
      {%- if h contains "</h2>" or h contains "</h3>" -%}
        {%- assign level = h | slice:0,1 | plus:0 -%}
        {%- assign title = h | split:">" | last | split:"</h" | first | strip -%}
        {%- assign id = title | slugify -%}

        <!-- Inject id into heading in content -->
        {% capture old_h %}<h{{ level }}>{{ title }}{% endcapture %}
        {% capture new_h %}<h{{ level }} id="{{ id }}">{{ title }}{% endcapture %}
        {% assign content = content | replace: old_h, new_h %}

        <li class="lvl-{{ level }}">
          <a href="#{{ id }}">{{ title }}</a>
        </li>
      {%- endif -%}
    {%- endfor -%}
  </ul>
</nav>
{% endif %}
